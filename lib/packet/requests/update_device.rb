module Fog
  module Compute
    class Packet
      class Real
        def update_device(device_id, options)

          device = Hash.new{}
          device['hostname'] = options[:hostname] if options[:hostname]
          device['description'] = options[:description] if options[:description]
          device['billing_cycle'] = options[:billing_cycle] if options[:billing_cycle]
          device['userdata'] = options[:userdata] if options[:userdata]
          device['locked'] = options[:locked] if options[:locked]
          device['tags'] = options[:tags] if options[:tags]
          device['always_pxe'] = options[:always_pxe] if options[:always_pxe]
          device['ipxe_script_url'] = options[:ipxe_script_url] if options[:ipxe_script_url]
          device['spot_instance'] = options[:spot_instance] if options[:spot_instance]

          request(
            expects: [200],
            method: 'PUT',
            path: '/devices/' + device_id,
            body: Fog::JSON.encode(device)
          )
        end
      end

      class Mock
        def update_device(device_id, options)
          response = Excon::Response.new
          response.status = 200
          response.body = {"id"=>"27adc441-4e4e-425a-b830-03cb1c2f2c51", "short_id"=>"27adc441", "hostname"=>"test02", "description"=>nil, "state"=>"active", "tags"=>[], "image_url"=>nil, "billing_cycle"=>"hourly", "user"=>"core", "iqn"=>"iqn.2018-03.net.packet:device.27adc441", "locked"=>false, "bonding_mode"=>5, "created_at"=>"2018-03-07T23:13:40Z", "updated_at"=>"2018-03-07T23:20:37Z", "ipxe_script_url"=>nil, "always_pxe"=>false, "storage"=>nil, "operating_system"=>{"id"=>"d61c3912-8422-4daf-835e-854efa0062e4", "slug"=>"coreos_stable", "name"=>"Container Linux (CoreOS) - Stable", "distro"=>"coreos", "version"=>"stable", "provisionable_on"=>["m2.xlarge.x86", "baremetal_0", "baremetal_1", "baremetal_2", "baremetal_3"], "default_cidr_size"=>31}, "facility"=>{"id"=>"e1e9c52e-a0bc-4117-b996-0fc94843ea09", "name"=>"Parsippany, NJ", "code"=>"ewr1", "features"=>["baremetal", "storage", "backend_transfers", "layer_2"], "address"=>nil, "ip_ranges"=>["2604:1380::/36", "147.75.192.0/21", "147.75.64.0/22", "147.75.72.0/22", "147.75.76.0/22", "147.75.104.0/22", "147.75.96.0/20"]}, "project"=>{"href"=>"/projects/93125c2a-8b78-4d4f-a3c4-7367d6b7cca8"}, "ssh_keys"=>[{"href"=>"/ssh-keys/a3d8bebe-574f-427d-80ee-bc2ba17f7074"}, {"href"=>"/ssh-keys/61905e3c-aa23-4ad3-922d-63cbd29060f9"}, {"href"=>"/ssh-keys/eacfb002-45e1-4047-a0d5-cd9d8bab19ed"}, {"href"=>"/ssh-keys/a8d6cc17-7d9d-4fb9-8190-afdb301b67df"}, {"href"=>"/ssh-keys/084a5dec-30be-415a-8937-9c615932e459"}, {"href"=>"/ssh-keys/38f2f61a-e0d7-4753-bebb-b580da2d43ac"}], "project_lite"=>{"href"=>"/projects/93125c2a-8b78-4d4f-a3c4-7367d6b7cca8"}, "volumes"=>[], "ip_addresses"=>[{"id"=>"5cf791f4-a891-4970-8946-3ec0ff69c9f6", "address_family"=>4, "netmask"=>"255.255.255.254", "created_at"=>"2018-03-07T23:13:43Z", "public"=>true, "cidr"=>31, "management"=>true, "manageable"=>true, "enabled"=>true, "project"=>{}, "project_lite"=>{}, "facility"=>{"id"=>"e1e9c52e-a0bc-4117-b996-0fc94843ea09", "name"=>"Parsippany, NJ", "code"=>"ewr1", "features"=>["baremetal", "storage", "backend_transfers", "layer_2"], "address"=>nil, "ip_ranges"=>["2604:1380::/36", "147.75.192.0/21", "147.75.64.0/22", "147.75.72.0/22", "147.75.76.0/22", "147.75.104.0/22", "147.75.96.0/20"]}, "assigned_to"=>{"href"=>"/devices/27adc441-4e4e-425a-b830-03cb1c2f2c51"}, "interface"=>{"href"=>"/ports/4208eb3d-f89b-4003-b9ad-616811ca0110"}, "network"=>"147.75.73.144", "address"=>"147.75.73.145", "gateway"=>"147.75.73.144", "href"=>"/ips/5cf791f4-a891-4970-8946-3ec0ff69c9f6"}, {"id"=>"e3d2ee87-ea7b-48e8-b099-e2e0ea0b4f7e", "address_family"=>6, "netmask"=>"ffff:ffff:ffff:ffff:ffff:ffff:ffff:fffe", "created_at"=>"2018-03-07T23:13:42Z", "public"=>true, "cidr"=>127, "management"=>true, "manageable"=>true, "enabled"=>true, "project"=>{}, "project_lite"=>{}, "facility"=>{"id"=>"e1e9c52e-a0bc-4117-b996-0fc94843ea09", "name"=>"Parsippany, NJ", "code"=>"ewr1", "features"=>["baremetal", "storage", "backend_transfers", "layer_2"], "address"=>nil, "ip_ranges"=>["2604:1380::/36", "147.75.192.0/21", "147.75.64.0/22", "147.75.72.0/22", "147.75.76.0/22", "147.75.104.0/22", "147.75.96.0/20"]}, "assigned_to"=>{"href"=>"/devices/27adc441-4e4e-425a-b830-03cb1c2f2c51"}, "interface"=>{"href"=>"/ports/4208eb3d-f89b-4003-b9ad-616811ca0110"}, "network"=>"2604:1380:0:8900::", "address"=>"2604:1380:0:8900::1", "gateway"=>"2604:1380:0:8900::", "href"=>"/ips/e3d2ee87-ea7b-48e8-b099-e2e0ea0b4f7e"}, {"id"=>"fe6af332-0f46-4666-8590-a39392c28aba", "address_family"=>4, "netmask"=>"255.255.255.254", "created_at"=>"2018-03-07T23:13:42Z", "public"=>false, "cidr"=>31, "management"=>true, "manageable"=>true, "enabled"=>true, "project"=>{}, "project_lite"=>{}, "facility"=>{"id"=>"e1e9c52e-a0bc-4117-b996-0fc94843ea09", "name"=>"Parsippany, NJ", "code"=>"ewr1", "features"=>["baremetal", "storage", "backend_transfers", "layer_2"], "address"=>nil, "ip_ranges"=>["2604:1380::/36", "147.75.192.0/21", "147.75.64.0/22", "147.75.72.0/22", "147.75.76.0/22", "147.75.104.0/22", "147.75.96.0/20"]}, "assigned_to"=>{"href"=>"/devices/27adc441-4e4e-425a-b830-03cb1c2f2c51"}, "interface"=>{"href"=>"/ports/4208eb3d-f89b-4003-b9ad-616811ca0110"}, "network"=>"10.99.80.128", "address"=>"10.99.80.129", "gateway"=>"10.99.80.128", "href"=>"/ips/fe6af332-0f46-4666-8590-a39392c28aba"}], "plan"=>{"id"=>"e69c0169-4726-46ea-98f1-939c9e8a3607", "slug"=>"baremetal_0", "name"=>"Type 0", "description"=>"Our Type 0 configuration is a general use \"cloud killer\" server, with a Intel Atom 2.4Ghz processor and 8GB of RAM.", "line"=>"baremetal", "specs"=>{"cpus"=>[{"count"=>1, "type"=>"Intel Atom C2550 @ 2.4Ghz"}], "memory"=>{"total"=>"8GB"}, "drives"=>[{"count"=>1, "size"=>"80GB", "type"=>"SSD"}], "nics"=>[{"count"=>2, "type"=>"1Gbps"}], "features"=>{"raid"=>false, "txt"=>true}}, "available_in"=>[{"href"=>"/facilities/8ea03255-89f9-4e62-9d3f-8817db82ceed"}, {"href"=>"/facilities/2b70eb8f-fa18-47c0-aba7-222a842362fd"}, {"href"=>"/facilities/8e6470b3-b75e-47d1-bb93-45b225750975"}, {"href"=>"/facilities/e1e9c52e-a0bc-4117-b996-0fc94843ea09"}], "pricing"=>{"hour"=>0.07}}, "userdata"=>"", "switch_uuid"=>"b2f07ffb", "network_ports"=>[{"id"=>"4208eb3d-f89b-4003-b9ad-616811ca0110", "type"=>"NetworkBondPort", "name"=>"bond0", "data"=>{"bonded"=>true}, "hardware"=>{"href"=>"/hardware/e1515887-eb8a-48bf-95f9-e0e1c9792da2"}, "virtual_networks"=>[], "connected_port"=>nil, "href"=>"/ports/4208eb3d-f89b-4003-b9ad-616811ca0110"}, {"id"=>"f959b220-cfc8-4ecf-a706-dfc433983c80", "type"=>"NetworkPort", "name"=>"eth0", "data"=>{"mac"=>"0c:c4:7a:b5:88:d8", "bonded"=>true}, "bond"=>{"id"=>"4208eb3d-f89b-4003-b9ad-616811ca0110", "name"=>"bond0"}, "hardware"=>{"href"=>"/hardware/e1515887-eb8a-48bf-95f9-e0e1c9792da2"}, "virtual_networks"=>[], "connected_port"=>{"href"=>"/ports/da8c573b-6b8f-48ba-8891-e19b67f66515"}, "href"=>"/ports/f959b220-cfc8-4ecf-a706-dfc433983c80"}, {"id"=>"d23ee9c3-8d16-47c3-bd3e-c1e01c600cf4", "type"=>"NetworkPort", "name"=>"eth1", "data"=>{"mac"=>"0c:c4:7a:b5:88:d9", "bonded"=>true}, "bond"=>{"id"=>"4208eb3d-f89b-4003-b9ad-616811ca0110", "name"=>"bond0"}, "hardware"=>{"href"=>"/hardware/e1515887-eb8a-48bf-95f9-e0e1c9792da2"}, "virtual_networks"=>[], "connected_port"=>{"href"=>"/ports/6426e9b7-23fc-4ba4-869e-d98ade38a5f7"}, "href"=>"/ports/d23ee9c3-8d16-47c3-bd3e-c1e01c600cf4"}], "href"=>"/devices/27adc441-4e4e-425a-b830-03cb1c2f2c51"}
          response
        end
      end
    end
  end
end
